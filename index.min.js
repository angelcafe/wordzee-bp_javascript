function activarHerramientas(e){const t=document.getElementsByClassName("herramientas")[0];e.currentTarget.checked?(t.style.display="block",localStorage.setItem("ActivarHerramientas","block")):(t.style.display="none",localStorage.setItem("ActivarHerramientas","none"))}function ajax(e=null,t=!1){let a=new Headers;a.append("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");let n={method:"POST",headers:a,body:e,cache:"no-cache"};var r=new Request("back/buscapalabras.php",n);fetch(r).then(e=>{if(200==e.status)return e.json();throw"Respuesta incorrecta del servidor"}).then(function(a){t?t(t):-1!==e.indexOf("borrar")||-1!==e.indexOf("guardar")?document.getElementById("principal").submit():-1!==e.indexOf("cargar")&&palabrasCargadas(a)}).catch(function(e){console.log(e)})}function alerta(e,t){var a=document.getElementById("liveAlertPlaceholder"),n=document.createElement("div");n.innerHTML='<div class="alert alert-'+t+' alert-dismissible" role="alert">'+e+'<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>',a.append(n)}function buscarPalabras(){if(Array.from(document.querySelectorAll("input[required]")).every(e=>""!=e.value)){var e=document.forms[0];fPuntosExtra(e),fLetrasDisponibles(e),fRonda(e),fPalabrasEncontradas()}else alerta("Hay que rellenar todas las Letras disponibles","danger")}function cambiarValorBotones(e){const t=e.srcElement;switch(t.value){case"":t.value="DL",t.className="btn rosa";break;case"DL":t.value="TL",t.className="btn btn-success";break;case"TL":t.value="",t.className="btn btn-info"}}function inicio(){document.getElementsByName("pal6let6")[0].value="DP",document.getElementsByName("pal6let6")[0].className="btn btn-primary",document.getElementsByName("pal7let7")[0].value="TP",document.getElementsByName("pal7let7")[0].className="btn btn-danger",document.querySelectorAll("#idPuntosExtra input").forEach(e=>e.addEventListener("click",cambiarValorBotones)),localStorage.getItem("ActivarHerramientas")&&(document.getElementsByClassName("herramientas")[0].style.display=localStorage.getItem("ActivarHerramientas"),document.getElementById("idActivarHerramientas").checked=localStorage.getItem("ActivarHerramientas").indexOf("none")<0),document.getElementById("idActivarHerramientas").addEventListener("change",activarHerramientas),Array.from(document.getElementsByClassName("palenc")).forEach(e=>{e.addEventListener("click",function(e){let t=e.target.innerText.split(" ")[0];if(t.length>0)for(let e=0;e<7;e++)document.getElementsByName("letra"+(e+1))[0].value=t[e]})});var e=/^[a-jl-vx-zA-JL-VX-ZñÑ]$/;document.querySelectorAll("#letras > input").forEach(t=>{t.addEventListener("keyup",a=>{!0===e.test(t.value)?a.currentTarget.nextElementSibling&&(a.currentTarget.nextElementSibling.focus(),a.currentTarget.nextElementSibling.select()):a.currentTarget.value=""}),t.addEventListener("click",e=>{e.currentTarget.select()})}),document.getElementById("idBorrar").addEventListener("click",function(){palabras.borrar(document.getElementById("palabraBorrar").value)}),document.getElementById("idGuardar").addEventListener("click",function(){ajax("guardar="+document.getElementById("palabraGuardar").value)}),document.onclick=function(){document.getElementById("menu").style.display="none"},document.oncontextmenu=function(e){if(document.getElementById("menu").style.display="none",e.target.className.includes("menu")){e.preventDefault();let t=document.getElementById("menu");t.style.left=e.pageX-100+"px",t.style.top=e.pageY+"px",t.style.display="block";let a=document.getElementById("idBorrarPalabra");a.innerText=e.target.innerText.split(" ")[0],a.addEventListener("click",function(e){palabras.borrar(e.innerText)})}}}function fLetrasDisponibles(e){let t=25;for(let a=0;a<7;a++)letrasDisponibles[a]=e[t].value.toUpperCase(),t++}function palabrasCargadas(e){e.forEach(function(e){vPalabras.push({nombre:e,longitud:e.length})})}function fPalabrasEncontradas(){let e=new Array,t=new Array,a=vPalabras.filter(function(e){let t=e.nombre.split(""),a=0;for(let n=0;n<t.length;n++){if(-1===letrasDisponibles.indexOf(t[n])||e.nombre.split(t[n]).length-1>letrasDisponibles.join("").split(t[n]).length-1)return!1;let r=puntos[t[n]]*puntosExtra[e.longitud][n]*ronda;6==e.longitud?r*=2:7==e.longitud&&(r*=3),a+=r}return e.puntos=a,!0});a.sort(function(e,t){return e.puntos<t.puntos?1:e.puntos>t.puntos?-1:0}),a.forEach(function(a){Array.isArray(e[a.longitud])&&Array.isArray(t[a.longitud])||(e[a.longitud]=new Array,t[a.longitud]=new Array),e[a.longitud].push(a.nombre),t[a.longitud].push(a.puntos)});const n=document.getElementById("idPalabrasEncontradas");for(;n.firstChild;)n.removeChild(n.firstChild);for(let a=0;a<10;a++){let r=document.createElement("tr");for(let n=3;n<8;n++){let l=document.createElement("td");if(e[n][a]){l.className="menu palenc noselect";let r=document.createTextNode(e[n][a]+" - "+t[n][a]);l.appendChild(r)}r.appendChild(l)}n.appendChild(r)}}function fPuntosExtra(e){let t,a=0;for(let n=3;n<8;n++){puntosExtra[n]=new Array;for(let r=0;r<n;r++)t="DL"==e[a].value?2:"TL"==e[a].value?3:1,puntosExtra[n][r]=t,a++}}function restablecer(){window.location.href=window.location.href}function fRonda(e){let t=32;for(let a=0;a<5;a++){if(e[t].checked){ronda=t-31;break}t++}}var ronda,puntosExtra=new Array,letrasDisponibles=new Array,vPalabras=new Array,palabrasSugeridas=new Array,puntos=new Array;puntos={A:1,B:3,C:3,D:2,E:1,F:4,G:2,H:4,I:1,J:8,L:1,M:3,N:1,"Ñ":8,O:1,P:3,Q:5,R:1,S:1,T:1,U:1,V:4,X:8,Y:4,Z:10},function(){"use strict";ajax("cargar=todo"),inicio()}();